!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(n.reduxObservableStreamLite={})}(this,function(n){var t=function(n){return!0===n.active},e=function(n){return!t(n)},r=function(n){return 0===n.dependencies.length&&n.producer},i=function(n){return n.then?(t=n,O({cancelled:!1,start:function(n){var e=this;if(this.cancelled=!1,!t.then)return n.next(t),void n.complete();t.then(function(t){e.cancelled||(n.next(t),n.complete())},function(t){e.cancelled||n.error(t)})},onStop:function(){this.cancelled=!0}})):n;var t},c=function(n){return 0===n.subscribers.length},u=function(n){return n.dependencies.every(e)},o=function(n){return n.dependents.every(e)},f=function(n,t){return n.subscribers=n.subscribers.filter(function(n){return n!==t})},s=function(n){return c(n)&&o(n)};function a(n){n.active=!0,n.hasEmitted=!1,n.onStart()}function d(n){n.producer&&n.producer.start(n)}function p(n){n.active=!1,n.onStop(),n.producer&&n.producer.stop()}function h(n,t,e){n=n||function(){},t=t||function(n){throw new Error(n)},e=e||function(){};var i="function"==typeof n?{next:n,error:t,complete:e}:n;return function(n){return n.subscribers.push(i),1===n.subscribers.length&&(a(n),r(n)&&d(n),w(n,"activated")),{unsubscribe:function(){c(n)||(f(n,i),c(n)&&o(n)&&(p(n),w(n,"completed")))}}}}var l={subscribe:function(){return h.apply(void 0,arguments)(this)},next:function(n){x(this,n)},error:function(n){!function(n,t){var e=[].concat(n.subscribers);n.subscribers=[],p(n),w(n,"error"),n.dependents.forEach(function(n){return n.error(t)}),e.forEach(function(n){return n.error(t)})}(this,n)},complete:function(){I(this)},pipe:function(){return function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return 1===t.length?t[0]:t.reduce(function(n,t){return function(){return t(n.apply(void 0,arguments))}})}.apply(void 0,arguments)(this)},nextGuard:function(){return m(this)},onStart:function(){},onStop:function(){},getValue:function(){return this.val}},b=function(n){return Object.assign({},{active:!1,hasEmitted:!1,dependencies:[],dependents:[],subscribers:[]},n)};function v(n,t){n.dependencies=t?[t]:n.dependencies||[];var e=Object.assign(Object.create(l),b(n)),r=e.next;return e.next=function(){if(e.nextGuard())try{for(var n=arguments.length,t=new Array(n),i=0;i<n;i++)t[i]=arguments[i];r.call.apply(r,[e].concat(t))}catch(n){if(!e.active)throw n;e.error(n)}},e.dependencies.forEach(function(n){return n.dependents.push(e)}),e}function x(n,t){return n.hasEmitted=!0,n.val=t,n.subscribers.forEach(function(n){return n.next(t)}),n.dependents.forEach(function(n){return n.next(t)}),n}var m=function(n){return!0===n.active},y=[],E=function(n,t){n.dependencies.filter(function(n){return t(n)&&-1===y.indexOf(n)}).forEach(function(n){return y.push(n)})},g=function(n,t){var e=t.predicate,r=t.action,i=t.actionGuard,c=n;for(e=e||function(){return!0},i=i||function(){return!0},E(c,e),c=y.shift();c;)i(c)&&(r(c),E(c,e)),c=y.shift()},S={activated:function(n){var t=[];g(n,{predicate:e,action:function(n){a(n),r(n)&&t.push(n)}}),t.forEach(d)},completed:function(n){return g(n,{predicate:t,action:p,actionGuard:s})},error:function(n){return g(n,{predicate:t,action:p})}},w=function(n,t){return S[t](n)};function I(n){var t=[].concat(n.subscribers);n.subscribers=[],p(n),w(n,"completed"),n.dependents.filter(u).forEach(function(n){return n.complete()}),t.forEach(function(n){return n.complete()})}var O=function(n){return void 0===n&&(n={}),n.start=n.start||function(){},n.stop=n.stop||function(){},v({producer:n})},j=function(n){return function(t){return v({next:function(t){n(t)&&x(this,t)}},t)}},G=function(n,t){return function(e){var r;t=t||function(n,t){return t};var c,u,o=0;return v({next:function(n){r&&r.unsubscribe(),r=this.subscribeToInner({outerValue:n,outerIndex:o++})},onStop:function(){r&&r.unsubscribe(),r=null,o=0,c=!1,u=!1},complete:function(){c=!0,u&&I(this)},subscribeToInner:function(e){var r=this,c=e.outerValue,u=e.outerIndex,o=0;return i(n(c,u)).subscribe(function(n){return r.tryNext(t.bind(r,c,n,u,o++))},this.error.bind(this),this.innerStreamComplete.bind(this))},innerStreamComplete:function(){u=!0,c&&this.complete()},tryNext:function(n){var t;try{t=n()}catch(n){this.error(n)}x(this,t)}},e)}};n.createEpicMiddleware=function(n,t){void 0===t&&(t={});var e,r=O(),i=O();i.ofType=function(n){return i.pipe(j(function(t){return t.type===n}))};var c=function(c){return e=c,function(c){return r.pipe(G(function(n){return n(i,e,t.dependencies)}),h(e.dispatch)),r.next(n),function(n){var t=c(n);return i.next(n),t}}};return c.replaceEpic=function(n){e.dispatch({type:"EPIC_END"}),r.next(n)},c},n.combineEpics=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];return function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return v({dependencies:t})}.apply(void 0,n.map(function(n){return n.apply(void 0,t)}))}}});
//# sourceMappingURL=index.umd.js.map
